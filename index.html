<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Melbourne Pixel Map</title>

  <!-- ğŸ® í”½ì…€ í°íŠ¸ -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      background: #f3efe3;
      font-family: 'Press Start 2P', monospace;
      text-align: center;
    }

    h1 {
      margin-top: 20px;
    }

    /* ğŸ® ê²Œì„ HUD ìŠ¤íƒ€ì¼ */
    .menu {
      margin: 15px 0;
    }

    .menu button {
      font-family: 'Press Start 2P';
      background: #222;
      color: #fff;
      border: 4px solid #000;
      padding: 10px 14px;
      margin: 4px;
      cursor: pointer;
    }

    .menu button:hover {
      background: #ffcc00;
      color: #000;
    }

    /* ğŸ® ê²Œì„ í”„ë ˆì„ ì§€ë„ */
    #map {
      width: 92%;
      height: 65vh;
      margin: auto;
      border: 8px solid black;
      box-shadow:
        0 0 0 8px #4a4a4a,
        0 0 0 16px #222;
    }

    /* ğŸ® í”½ì…€ íŒì—… ìŠ¤íƒ€ì¼ */
    .gm-style .gm-style-iw-c {
      border-radius: 0 !important;
      padding: 12px !important;
      font-family: 'Press Start 2P';
    }
  .retro-popup{
    background:#f4f1e8;
    border:2px solid #000;
    padding:8px 12px;
    font-family:'Press Start 2P', monospace;
    font-size:10px;
    line-height:1.4;
  }
  </style>
</head>

<body>

  <h1>ğŸŒ Melbourne Pixel Map</h1>
  <p>Explore like a retro adventure ğŸ®</p>

  <!-- ğŸ® ì¹´í…Œê³ ë¦¬ ë©”ë‰´ -->
  <div class="menu">
    <button onclick="showCategory('all')">ALL</button>
    <button onclick="showCategory('food')">FOOD</button>
    <button onclick="showCategory('shop')">SHOP</button>
    <button onclick="showCategory('landmark')">LANDMARK</button>
  </div>

  <div id="map"></div>

<script>
  let map;
  const markers = []; // ëª¨ë“  ë§ˆì»¤ ì €ì¥

  // âœ… ë§ˆì»¤ ë§Œë“¤ê¸° í•¨ìˆ˜ (initMap ë°–ì— ë‘ )
  function addMarker(lat, lng, title, category, iconFile = null) {
    const markerOptions = {
      position: { lat, lng },
      map,
      title
    };

    // ì•„ì´ì½˜ì´ ìˆëŠ” ë§ˆì»¤ë§Œ ì»¤ìŠ¤í…€ ì•„ì´ì½˜ ì ìš©
    if (iconFile) {
      markerOptions.icon = {
        url: iconFile,
        scaledSize: new google.maps.Size(52, 52),
        anchor: new google.maps.Point(26, 52) // ì•„ë˜ ì¤‘ì•™
      };
    }

    const marker = new google.maps.Marker(markerOptions);

    marker.category = category;
    marker.iconUrl = iconFile; // âœ… ë‚˜ì¤‘ì— ì¤Œì— ë”°ë¼ ì‚¬ì´ì¦ˆ ë°”ê¿€ ë•Œ í•„ìš”

    const info = new google.maps.InfoWindow({
      content: `
        <div class="retro-popup">
          ${title}
        </div>
      `
    });

    marker.addListener("click", () => info.open(map, marker));

    markers.push(marker);
    return marker;
  }

  // âœ… ì¤Œì— ë”°ë¼ ì•„ì´ì½˜ í¬ê¸° ë°”ê¾¸ëŠ” í•¨ìˆ˜ (initMap ë°–)
  function updateMarkerSize() {
  const zoom = map.getZoom();

  let size;

  if (zoom >= 17) size = 420;
  else if (zoom >= 16) size = 360;
  else if (zoom >= 15) size = 300;
  else if (zoom >= 14) size = 240;
  else if (zoom >= 13) size = 200;
  else size = 160;   // â­ ê¸°ë³¸ê°’ë„ í¼

  markers.forEach(marker => {
    const icon = marker.getIcon();
    if (icon && icon.url) {
      marker.setIcon({
        url: icon.url,
        scaledSize: new google.maps.Size(size, size),
        anchor: new google.maps.Point(size / 2, size)
      });
    }
  });
}
  // âœ… ì—¬ê¸°ì„œë¶€í„°ê°€ initMap (ì§€ë„ ìƒì„± + ë§ˆì»¤ ì¶”ê°€ "í˜¸ì¶œ"ë§Œ)
  function initMap() {
    const melbourne = { lat: -37.8136, lng: 144.9631 };

    map = new google.maps.Map(document.getElementById("map"), {
      zoom: 13,
      center: melbourne,
      disableDefaultUI: true,
      styles: [
        { featureType: "all", elementType: "labels", stylers: [{ visibility: "off" }] },
        { featureType: "poi", stylers: [{ visibility: "off" }] },
        { featureType: "transit", stylers: [{ visibility: "off" }] },

        { featureType: "landscape", elementType: "geometry", stylers: [{ color: "#f3efe3" }] },
        { featureType: "water", elementType: "geometry", stylers: [{ color: "#b7d3d0" }] },
        { featureType: "road", elementType: "geometry", stylers: [{ color: "#a08f6d" }] },
        { featureType: "road.local", elementType: "geometry", stylers: [{ color: "#c2b59b" }] },
        { featureType: "poi.park", elementType: "geometry", stylers: [{ color: "#d8e2c8" }] }
      ]
    });

    // âœ… ë§ˆì»¤ ì¶”ê°€ (í”Œë¦°ë”ìŠ¤ë§Œ ì•„ì´ì½˜ ì ìš©)
    addMarker(-37.8183, 144.9671, "Flinders Street Station", "landmark", "icons/landmark-flinders.png");
    addMarker(-37.8122, 144.9623, "Queen Victoria Market", "shop");
    addMarker(-37.8150, 144.9605, "Hardware SociÃ©tÃ©", "food");

    // âœ… ì¤Œ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì•„ì´ì½˜ í¬ê¸° ì—…ë°ì´íŠ¸
    map.addListener("zoom_changed", updateMarkerSize);

    // âœ… ì²˜ìŒ ë¡œë“œë  ë•Œë„ 1ë²ˆ ì‹¤í–‰
    updateMarkerSize();
  }
</script>
  <script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBOL2NKHM4lBk7SMTaaVMYsJPGQmEpvylw&callback=initMap">
  </script>
